{% extends "base.html" %}
{% block title %}비밀번호 찾기 - TU Air{% endblock %}

{% block content %}
<div class="register-container"> <h1 class="register-title">비밀번호 찾기</h1>

    {% if found_password %}
        <div class="find-result success">
            회원님의 비밀번호는 <strong>[ {{ found_password }} ]</strong> 입니다.
            <a href="{{ url_for('auth.login') }}" class="btn-go-login">로그인하기</a>
        </div>
        <p class="find-result-warning">
            (학습용) 보안을 위해 로그인 후 즉시 비밀번호를 변경해주세요.
        </p>
    {% elif error %}
        <div class="find-result error">{{ error }}</div>
    {% endif %}

    <form class="register-form" method="POST" action="{{ url_for('auth.find_password') }}">
        
        <div class="form-group-register">
            <label for="member_id">아이디</label>
            <input type="text" id="member_id" name="member_id" class="form-input-register" required>
        </div>

        <div class="form-group-register">
            <label for="name">이름</label>
            <input type="text" id="name" name="name" class="form-input-register" required>
        </div>

        <div class="form-group-register">
            <label>생년월일</label>
            <div class="dob-wrapper">
                <select id="dob_year" name="dob_year" class="form-input-register dob-select" required>
                    <option value="" disabled selected>출생 연도</option>
                </select>
                <select id="dob_month" name="dob_month" class="form-input-register dob-select" required>
                    <option value="" disabled selected>월</option>
                </select>
                <select id="dob_day" name="dob_day" class="form-input-register dob-select" required>
                    <option value="" disabled selected>일</option>
                </select>
            </div>
        </div>

        <div class="form-group-register">
            <label for="phone">휴대전화</label>
            <input type="tel" id="phone" name="phone" class="form-input-register" placeholder="예: 010-1234-5678" required>
        </div>
        
        <button type="submit" class="btn-register-submit">비밀번호 찾기</button>
    </form>
</div>
{% endblock %}

{% block scripts %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    // ( ... find_id.html과 동일한 생년월일 스크립트 ... )
    const yearSelect = document.getElementById('dob_year');
    const monthSelect = document.getElementById('dob_month');
    const daySelect = document.getElementById('dob_day');
    const currentYear = new Date().getFullYear();
    for (let i = currentYear; i >= 1920; i--) {
        yearSelect.add(new Option(i + "년", i));
    }
    for (let i = 1; i <= 12; i++) {
        monthSelect.add(new Option(i + "월", i));
    }
    function populateDays(daysInMonth) {
        daySelect.innerHTML = '<option value="" disabled selected>일</option>';
        for (let i = 1; i <= daysInMonth; i++) {
            daySelect.add(new Option(i + "일", i));
        }
    }
    populateDays(31);
    function updateDays() {
        const year = parseInt(yearSelect.value);
        const month = parseInt(monthSelect.value);
        if (year && month) {
            const daysInMonth = new Date(year, month, 0).getDate();
            populateDays(daysInMonth);
        }
    }
    yearSelect.addEventListener('change', updateDays);
    monthSelect.addEventListener('change', updateDays);
});
</script>
{% endblock %}